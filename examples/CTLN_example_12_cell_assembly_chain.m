% CTLN_example_12_cell_assembly_chain.m
%
% comments: graph with six overlapping 5-cliques, each with a target. 
% This corresponds to Figure 11A of the paper https://arxiv.org/abs/1605.04463
%
% Option at end of file to save data as: examples/CTLN_example_12_cell_assembly_chain.mat

% adjacency matrix 
sA = [ 0  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       1  0  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       1  1  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       1  1  1  0  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0; ...
       1  1  1  1  0  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0; ...
       0  0  0  1  1  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0; ...
       0  0  0  1  1  1  0  1  1  1  1  0  0  0  0  0  0  0  0  0  1  1  0  0  0; ...
       0  0  0  1  1  1  1  0  1  1  1  0  0  0  0  0  0  0  0  0  1  1  0  0  0; ...
       0  0  0  0  0  0  1  1  0  1  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0; ...
       0  0  0  0  0  0  1  1  1  0  1  1  1  1  0  0  0  0  0  0  0  1  1  0  0; ...
       0  0  0  0  0  0  1  1  1  1  0  1  1  1  0  0  0  0  0  0  0  1  1  0  0; ...
       0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0  0  0  0  0  0  1  0  0; ...
       0  0  0  0  0  0  0  0  0  1  1  1  0  1  1  1  1  0  0  0  0  0  1  1  0; ...
       0  0  0  0  0  0  0  0  0  1  1  1  1  0  1  1  1  0  0  0  0  0  1  1  0; ...
       0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0  0  0  0  1  0; ...
       0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  1  1  1  1  0  0  0  1  1; ...
       0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  1  1  1  0  0  0  1  1; ...
       0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0  0  1; ...
       0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  1  0  0  0  0  1; ...
       0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  0  1; ...
       1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       0  0  0  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       0  0  0  0  0  0  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0; ...
       0  0  0  0  0  0  0  0  0  1  1  1  1  1  0  0  0  0  0  0  0  0  0  0  0; ...
       0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  1  0  0  0  0  0  0  0  0 ]; 

% simulation parameters 
n = 25;    % number of neurons 
e = 0.25;  % epsilon value 
d = 0.5;   % delta value 
theta = 1;   % external drive
T = 50;   % time in units of membrane time constant

% initial conditions 
X0cell=[]; % initialize cell array of interesting initial conditions 
X0cell{1} = [ 0.110   0.109   0.104   0.105   0.102   0.008   0.009   0.009   0.006   0.006   ...
              0.001   0.009   0.005   0.002   0.009   0.008   0.009   0.003   0.007   0.007   ...
              0.001   0.004   0.003   0.007   0.003];

X0 = X0cell{1};   % for other initial conditions, modify command to access other entries in cell array 

% projection 
proj = [ ]; 

% colors - need to match Figure 11A
colors_menu = [ 1.00 0.35 0.00;... % clique 1 
                0.80 0.00 0.00;... % clique 2
                0.00 0.50 0.70;... % clique 3 
                0.15 0.60 0.00;... % clique 4 
                0.50 0.50 0.50;... % clique 5 
                0.85 0.25 0.70;... % clique 6 
                0 0 0 ];  % target nodes

colors = zeros(n,3);
colors(1:3,:) = [1;1;1]*colors_menu(1,:);
colors(4:6,:) = [1;1;1]*colors_menu(2,:);
colors(7:9,:) = [1;1;1]*colors_menu(3,:);
colors(10:12,:) = [1;1;1]*colors_menu(4,:);
colors(13:15,:) = [1;1;1]*colors_menu(5,:);
colors(16:20,:) = [1;1;1;1;1]*colors_menu(6,:);
colors(21:25,:) = [1;1;1;1;1]*colors_menu(7,:);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

% To save .mat file, uncomment commands below 

% ex_num = 12;
% ex_name = 'cell_assembly_chain';
% graph_comments = 'graph with 6 overlapping 5-cliques, each with a target.  from Fig 11A of CTLN preprint.';
% 
% save('examples/CTLN_example_12_cell_assembly_chain.mat', 'sA', 'n', 'e', 'd','theta','T','X0','X0cell','proj','colors','ex_num','ex_name','graph_comments')
